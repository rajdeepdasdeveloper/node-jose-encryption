import{a as Ce,b as Te,c as $r,d as gt,e as ht,f as nr,g as yt,h as en,j as tn,k as ar,l as rn,m as nn,n as $e,o as _t,p as an,q as on,r as sn,s as ir,t as ln,u as un,v as fn,w as cn,x as or,y as sr}from"./chunk-2MTWQIWF.js";import{$ as Wt,B as De,Ca as lr,H as Xe,J as Ot,V as mt,Z as Yt,_ as zt,aa as _e,ba as Qt,ca as Je,da as Xt,ea as Ze,fa as Jt,ga as Zt,i as Ye,ia as $t,ja as er,k as Ie,ka as tr,l as ze,la as rr,ma as et,p as ie,q as Ut,r as ve,s as We,t as B,u as y,v as D,x as Le,y as Qe,z as E}from"./chunk-ESJO3J4D.js";import{d as pe,e as jt}from"./chunk-CGT2X6C5.js";var rt=pe((oa,dr)=>{"use strict";var me=Ce();nr();Te();var fr=dr.exports=me.md5=me.md5||{};me.md.md5=me.md.algorithms.md5=fr;fr.create=function(){cr||dn();var t=null,r=me.util.createBuffer(),a=new Array(16),e={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return e.start=function(){e.messageLength=0,e.fullMessageLength=e.messageLength64=[];for(var n=e.messageLengthSize/4,l=0;l<n;++l)e.fullMessageLength.push(0);return r=me.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},e},e.start(),e.update=function(n,l){l==="utf8"&&(n=me.util.encodeUtf8(n));var s=n.length;e.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var f=e.fullMessageLength.length-1;f>=0;--f)e.fullMessageLength[f]+=s[1],s[1]=s[0]+(e.fullMessageLength[f]/4294967296>>>0),e.fullMessageLength[f]=e.fullMessageLength[f]>>>0,s[0]=s[1]/4294967296>>>0;return r.putBytes(n),ur(t,a,r),(r.read>2048||r.length()===0)&&r.compact(),e},e.digest=function(){var n=me.util.createBuffer();n.putBytes(r.bytes());var l=e.fullMessageLength[e.fullMessageLength.length-1]+e.messageLengthSize,s=l&e.blockLength-1;n.putBytes(Ct.substr(0,e.blockLength-s));for(var f,p=0,d=e.fullMessageLength.length-1;d>=0;--d)f=e.fullMessageLength[d]*8+p,p=f/4294967296>>>0,n.putInt32Le(f>>>0);var u={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3};ur(u,a,n);var v=me.util.createBuffer();return v.putInt32Le(u.h0),v.putInt32Le(u.h1),v.putInt32Le(u.h2),v.putInt32Le(u.h3),v},e};var Ct=null,tt=null,Fe=null,Ne=null,cr=!1;function dn(){Ct=String.fromCharCode(128),Ct+=me.util.fillString(String.fromCharCode(0),64),tt=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],Fe=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],Ne=new Array(64);for(var t=0;t<64;++t)Ne[t]=Math.floor(Math.abs(Math.sin(t+1))*4294967296);cr=!0}function ur(t,r,a){for(var e,n,l,s,f,p,d,u,v=a.length();v>=64;){for(n=t.h0,l=t.h1,s=t.h2,f=t.h3,u=0;u<16;++u)r[u]=a.getInt32Le(),p=f^l&(s^f),e=n+p+Ne[u]+r[u],d=Fe[u],n=f,f=s,s=l,l+=e<<d|e>>>32-d;for(;u<32;++u)p=s^f&(l^s),e=n+p+Ne[u]+r[tt[u]],d=Fe[u],n=f,f=s,s=l,l+=e<<d|e>>>32-d;for(;u<48;++u)p=l^s^f,e=n+p+Ne[u]+r[tt[u]],d=Fe[u],n=f,f=s,s=l,l+=e<<d|e>>>32-d;for(;u<64;++u)p=s^(l|~f),e=n+p+Ne[u]+r[tt[u]],d=Fe[u],n=f,f=s,s=l,l+=e<<d|e>>>32-d;t.h0=t.h0+n|0,t.h1=t.h1+l|0,t.h2=t.h2+s|0,t.h3=t.h3+f|0,v-=64}}});var kt=pe((sa,Cr)=>{"use strict";var c=Ce();ht();yt();rt();ar();or();$e();_t();Te();var ot=function(t,r,a,e){var n=c.util.createBuffer(),l=t.length>>1,s=l+(t.length&1),f=t.substr(0,s),p=t.substr(l,s),d=c.util.createBuffer(),u=c.hmac.create();a=r+a;var v=Math.ceil(e/16),g=Math.ceil(e/20);u.start("MD5",f);var C=c.util.createBuffer();d.putBytes(a);for(var h=0;h<v;++h)u.start(null,null),u.update(d.getBytes()),d.putBuffer(u.digest()),u.start(null,null),u.update(d.bytes()+a),C.putBuffer(u.digest());u.start("SHA1",p);var T=c.util.createBuffer();d.clear(),d.putBytes(a);for(var h=0;h<g;++h)u.start(null,null),u.update(d.getBytes()),d.putBuffer(u.digest()),u.start(null,null),u.update(d.bytes()+a),T.putBuffer(u.digest());return n.putBytes(c.util.xorBytes(C.getBytes(),T.getBytes(),e)),n},pn=function(t,r,a){var e=c.hmac.create();e.start("SHA1",t);var n=c.util.createBuffer();return n.putInt32(r[0]),n.putInt32(r[1]),n.putByte(a.type),n.putByte(a.version.major),n.putByte(a.version.minor),n.putInt16(a.length),n.putBytes(a.fragment.bytes()),e.update(n.getBytes()),e.digest().getBytes()},vn=function(t,r,a){var e=!1;try{var n=t.deflate(r.fragment.getBytes());r.fragment=c.util.createBuffer(n),r.length=n.length,e=!0}catch{}return e},mn=function(t,r,a){var e=!1;try{var n=t.inflate(r.fragment.getBytes());r.fragment=c.util.createBuffer(n),r.length=n.length,e=!0}catch{}return e},oe=function(t,r){var a=0;switch(r){case 1:a=t.getByte();break;case 2:a=t.getInt16();break;case 3:a=t.getInt24();break;case 4:a=t.getInt32();break}return c.util.createBuffer(t.getBytes(a))},ue=function(t,r,a){t.putInt(a.length(),r<<3),t.putBuffer(a)},o={};o.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};o.SupportedVersions=[o.Versions.TLS_1_1,o.Versions.TLS_1_0];o.Version=o.SupportedVersions[0];o.MaxFragment=16384-1024;o.ConnectionEnd={server:0,client:1};o.PRFAlgorithm={tls_prf_sha256:0};o.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};o.CipherType={stream:0,block:1,aead:2};o.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};o.CompressionMethod={none:0,deflate:1};o.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};o.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};o.Alert={};o.Alert.Level={warning:1,fatal:2};o.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};o.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};o.CipherSuites={};o.getCipherSuite=function(t){var r=null;for(var a in o.CipherSuites){var e=o.CipherSuites[a];if(e.id[0]===t.charCodeAt(0)&&e.id[1]===t.charCodeAt(1)){r=e;break}}return r};o.handleUnexpected=function(t,r){var a=!t.open&&t.entity===o.ConnectionEnd.client;a||t.error(t,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unexpected_message}})};o.handleHelloRequest=function(t,r,a){!t.handshaking&&t.handshakes>0&&(o.queue(t,o.createAlert(t,{level:o.Alert.Level.warning,description:o.Alert.Description.no_renegotiation})),o.flush(t)),t.process()};o.parseHelloMessage=function(t,r,a){var e=null,n=t.entity===o.ConnectionEnd.client;if(a<38)t.error(t,{message:n?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});else{var l=r.fragment,s=l.length();if(e={version:{major:l.getByte(),minor:l.getByte()},random:c.util.createBuffer(l.getBytes(32)),session_id:oe(l,1),extensions:[]},n?(e.cipher_suite=l.getBytes(2),e.compression_method=l.getByte()):(e.cipher_suites=oe(l,2),e.compression_methods=oe(l,1)),s=a-(s-l.length()),s>0){for(var f=oe(l,2);f.length()>0;)e.extensions.push({type:[f.getByte(),f.getByte()],data:oe(f,2)});if(!n)for(var p=0;p<e.extensions.length;++p){var d=e.extensions[p];if(d.type[0]===0&&d.type[1]===0)for(var u=oe(d.data,2);u.length()>0;){var v=u.getByte();if(v!==0)break;t.session.extensions.server_name.serverNameList.push(oe(u,2).getBytes())}}}if(t.session.version&&(e.version.major!==t.session.version.major||e.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});if(n)t.session.cipherSuite=o.getCipherSuite(e.cipher_suite);else for(var g=c.util.createBuffer(e.cipher_suites.bytes());g.length()>0&&(t.session.cipherSuite=o.getCipherSuite(g.getBytes(2)),t.session.cipherSuite===null););if(t.session.cipherSuite===null)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.handshake_failure},cipherSuite:c.util.bytesToHex(e.cipher_suite)});n?t.session.compressionMethod=e.compression_method:t.session.compressionMethod=o.CompressionMethod.none}return e};o.createSecurityParameters=function(t,r){var a=t.entity===o.ConnectionEnd.client,e=r.random.bytes(),n=a?t.session.sp.client_random:e,l=a?e:o.createRandom().getBytes();t.session.sp={entity:t.entity,prf_algorithm:o.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:t.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:n,server_random:l}};o.handleServerHello=function(t,r,a){var e=o.parseHelloMessage(t,r,a);if(!t.fail){if(e.version.minor<=t.version.minor)t.version.minor=e.version.minor;else return t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});t.session.version=t.version;var n=e.session_id.bytes();n.length>0&&n===t.session.id?(t.expect=mr,t.session.resuming=!0,t.session.sp.server_random=e.random.bytes()):(t.expect=hn,t.session.resuming=!1,o.createSecurityParameters(t,e)),t.session.id=n,t.process()}};o.handleClientHello=function(t,r,a){var e=o.parseHelloMessage(t,r,a);if(!t.fail){var n=e.session_id.bytes(),l=null;if(t.sessionCache&&(l=t.sessionCache.getSession(n),l===null?n="":(l.version.major!==e.version.major||l.version.minor>e.version.minor)&&(l=null,n="")),n.length===0&&(n=c.random.getBytes(32)),t.session.id=n,t.session.clientHelloVersion=e.version,t.session.sp={},l)t.version=t.session.version=l.version,t.session.sp=l.sp;else{for(var s,f=1;f<o.SupportedVersions.length&&(s=o.SupportedVersions[f],!(s.minor<=e.version.minor));++f);t.version={major:s.major,minor:s.minor},t.session.version=t.version}l!==null?(t.expect=St,t.session.resuming=!0,t.session.sp.client_random=e.random.bytes()):(t.expect=t.verifyClient!==!1?Sn:Et,t.session.resuming=!1,o.createSecurityParameters(t,e)),t.open=!0,o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createServerHello(t)})),t.session.resuming?(o.queue(t,o.createRecord(t,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),t.state.pending=o.createConnectionState(t),t.state.current.write=t.state.pending.write,o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createFinished(t)}))):(o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createCertificate(t)})),t.fail||(o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createServerKeyExchange(t)})),t.verifyClient!==!1&&o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createCertificateRequest(t)})),o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createServerHelloDone(t)})))),o.flush(t),t.process()}};o.handleCertificate=function(t,r,a){if(a<3)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var e=r.fragment,n={certificate_list:oe(e,3)},l,s,f=[];try{for(;n.certificate_list.length()>0;)l=oe(n.certificate_list,3),s=c.asn1.fromDer(l),l=c.pki.certificateFromAsn1(s,!0),f.push(l)}catch(d){return t.error(t,{message:"Could not parse certificate list.",cause:d,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate}})}var p=t.entity===o.ConnectionEnd.client;(p||t.verifyClient===!0)&&f.length===0?t.error(t,{message:p?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}}):f.length===0?t.expect=p?pr:Et:(p?t.session.serverCertificate=f[0]:t.session.clientCertificate=f[0],o.verifyCertificateChain(t,f)&&(t.expect=p?pr:Et)),t.process()};o.handleServerKeyExchange=function(t,r,a){if(a>0)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unsupported_certificate}});t.expect=yn,t.process()};o.handleClientKeyExchange=function(t,r,a){if(a<48)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unsupported_certificate}});var e=r.fragment,n={enc_pre_master_secret:oe(e,2).getBytes()},l=null;if(t.getPrivateKey)try{l=t.getPrivateKey(t,t.session.serverCertificate),l=c.pki.privateKeyFromPem(l)}catch(p){t.error(t,{message:"Could not get private key.",cause:p,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}})}if(l===null)return t.error(t,{message:"No private key set.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});try{var s=t.session.sp;s.pre_master_secret=l.decrypt(n.enc_pre_master_secret);var f=t.session.clientHelloVersion;if(f.major!==s.pre_master_secret.charCodeAt(0)||f.minor!==s.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{s.pre_master_secret=c.random.getBytes(48)}t.expect=St,t.session.clientCertificate!==null&&(t.expect=xn),t.process()};o.handleCertificateRequest=function(t,r,a){if(a<3)return t.error(t,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var e=r.fragment,n={certificate_types:oe(e,1),certificate_authorities:oe(e,2)};t.session.certificateRequest=n,t.expect=_n,t.process()};o.handleCertificateVerify=function(t,r,a){if(a<2)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var e=r.fragment;e.read-=4;var n=e.bytes();e.read+=4;var l={signature:oe(e,2).getBytes()},s=c.util.createBuffer();s.putBuffer(t.session.md5.digest()),s.putBuffer(t.session.sha1.digest()),s=s.getBytes();try{var f=t.session.clientCertificate;if(!f.publicKey.verify(s,l.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(n),t.session.sha1.update(n)}catch{return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.handshake_failure}})}t.expect=St,t.process()};o.handleServerHelloDone=function(t,r,a){if(a>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.record_overflow}});if(t.serverCertificate===null){var e={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.insufficient_security}},n=0,l=t.verify(t,e.alert.description,n,[]);if(l!==!0)return(l||l===0)&&(typeof l=="object"&&!c.util.isArray(l)?(l.message&&(e.message=l.message),l.alert&&(e.alert.description=l.alert)):typeof l=="number"&&(e.alert.description=l)),t.error(t,e)}t.session.certificateRequest!==null&&(r=o.createRecord(t,{type:o.ContentType.handshake,data:o.createCertificate(t)}),o.queue(t,r)),r=o.createRecord(t,{type:o.ContentType.handshake,data:o.createClientKeyExchange(t)}),o.queue(t,r),t.expect=Bn;var s=function(f,p){f.session.certificateRequest!==null&&f.session.clientCertificate!==null&&o.queue(f,o.createRecord(f,{type:o.ContentType.handshake,data:o.createCertificateVerify(f,p)})),o.queue(f,o.createRecord(f,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),f.state.pending=o.createConnectionState(f),f.state.current.write=f.state.pending.write,o.queue(f,o.createRecord(f,{type:o.ContentType.handshake,data:o.createFinished(f)})),f.expect=mr,o.flush(f),f.process()};if(t.session.certificateRequest===null||t.session.clientCertificate===null)return s(t,null);o.getClientSignature(t,s)};o.handleChangeCipherSpec=function(t,r){if(r.fragment.getByte()!==1)return t.error(t,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var a=t.entity===o.ConnectionEnd.client;(t.session.resuming&&a||!t.session.resuming&&!a)&&(t.state.pending=o.createConnectionState(t)),t.state.current.read=t.state.pending.read,(!t.session.resuming&&a||t.session.resuming&&!a)&&(t.state.pending=null),t.expect=a?Cn:kn,t.process()};o.handleFinished=function(t,r,a){var e=r.fragment;e.read-=4;var n=e.bytes();e.read+=4;var l=r.fragment.getBytes();e=c.util.createBuffer(),e.putBuffer(t.session.md5.digest()),e.putBuffer(t.session.sha1.digest());var s=t.entity===o.ConnectionEnd.client,f=s?"server finished":"client finished",p=t.session.sp,d=12,u=ot;if(e=u(p.master_secret,f,e.getBytes(),d),e.getBytes()!==l)return t.error(t,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.decrypt_error}});t.session.md5.update(n),t.session.sha1.update(n),(t.session.resuming&&s||!t.session.resuming&&!s)&&(o.queue(t,o.createRecord(t,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),t.state.current.write=t.state.pending.write,t.state.pending=null,o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createFinished(t)}))),t.expect=s?bn:Tn,t.handshaking=!1,++t.handshakes,t.peerCertificate=s?t.session.serverCertificate:t.session.clientCertificate,o.flush(t),t.isConnected=!0,t.connected(t),t.process()};o.handleAlert=function(t,r){var a=r.fragment,e={level:a.getByte(),description:a.getByte()},n;switch(e.description){case o.Alert.Description.close_notify:n="Connection closed.";break;case o.Alert.Description.unexpected_message:n="Unexpected message.";break;case o.Alert.Description.bad_record_mac:n="Bad record MAC.";break;case o.Alert.Description.decryption_failed:n="Decryption failed.";break;case o.Alert.Description.record_overflow:n="Record overflow.";break;case o.Alert.Description.decompression_failure:n="Decompression failed.";break;case o.Alert.Description.handshake_failure:n="Handshake failure.";break;case o.Alert.Description.bad_certificate:n="Bad certificate.";break;case o.Alert.Description.unsupported_certificate:n="Unsupported certificate.";break;case o.Alert.Description.certificate_revoked:n="Certificate revoked.";break;case o.Alert.Description.certificate_expired:n="Certificate expired.";break;case o.Alert.Description.certificate_unknown:n="Certificate unknown.";break;case o.Alert.Description.illegal_parameter:n="Illegal parameter.";break;case o.Alert.Description.unknown_ca:n="Unknown certificate authority.";break;case o.Alert.Description.access_denied:n="Access denied.";break;case o.Alert.Description.decode_error:n="Decode error.";break;case o.Alert.Description.decrypt_error:n="Decrypt error.";break;case o.Alert.Description.export_restriction:n="Export restriction.";break;case o.Alert.Description.protocol_version:n="Unsupported protocol version.";break;case o.Alert.Description.insufficient_security:n="Insufficient security.";break;case o.Alert.Description.internal_error:n="Internal error.";break;case o.Alert.Description.user_canceled:n="User canceled.";break;case o.Alert.Description.no_renegotiation:n="Renegotiation not supported.";break;default:n="Unknown error.";break}if(e.description===o.Alert.Description.close_notify)return t.close();t.error(t,{message:n,send:!1,origin:t.entity===o.ConnectionEnd.client?"server":"client",alert:e}),t.process()};o.handleHandshake=function(t,r){var a=r.fragment,e=a.getByte(),n=a.getInt24();if(n>a.length())return t.fragmented=r,r.fragment=c.util.createBuffer(),a.read-=4,t.process();t.fragmented=null,a.read-=4;var l=a.bytes(n+4);a.read+=4,e in it[t.entity][t.expect]?(t.entity===o.ConnectionEnd.server&&!t.open&&!t.fail&&(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:c.md.md5.create(),sha1:c.md.sha1.create()}),e!==o.HandshakeType.hello_request&&e!==o.HandshakeType.certificate_verify&&e!==o.HandshakeType.finished&&(t.session.md5.update(l),t.session.sha1.update(l)),it[t.entity][t.expect][e](t,r,n)):o.handleUnexpected(t,r)};o.handleApplicationData=function(t,r){t.data.putBuffer(r.fragment),t.dataReady(t),t.process()};o.handleHeartbeat=function(t,r){var a=r.fragment,e=a.getByte(),n=a.getInt16(),l=a.getBytes(n);if(e===o.HeartbeatMessageType.heartbeat_request){if(t.handshaking||n>l.length)return t.process();o.queue(t,o.createRecord(t,{type:o.ContentType.heartbeat,data:o.createHeartbeat(o.HeartbeatMessageType.heartbeat_response,l)})),o.flush(t)}else if(e===o.HeartbeatMessageType.heartbeat_response){if(l!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,c.util.createBuffer(l))}t.process()};var gn=0,hn=1,pr=2,yn=3,_n=4,mr=5,Cn=6,bn=7,Bn=8,En=0,Sn=1,Et=2,xn=3,St=4,kn=5,Tn=6,i=o.handleUnexpected,gr=o.handleChangeCipherSpec,K=o.handleAlert,te=o.handleHandshake,hr=o.handleApplicationData,M=o.handleHeartbeat,xt=[];xt[o.ConnectionEnd.client]=[[i,K,te,i,M],[i,K,te,i,M],[i,K,te,i,M],[i,K,te,i,M],[i,K,te,i,M],[gr,K,i,i,M],[i,K,te,i,M],[i,K,te,hr,M],[i,K,te,i,M]];xt[o.ConnectionEnd.server]=[[i,K,te,i,M],[i,K,te,i,M],[i,K,te,i,M],[i,K,te,i,M],[gr,K,i,i,M],[i,K,te,i,M],[i,K,te,hr,M],[i,K,te,i,M]];var Ee=o.handleHelloRequest,An=o.handleServerHello,yr=o.handleCertificate,vr=o.handleServerKeyExchange,bt=o.handleCertificateRequest,nt=o.handleServerHelloDone,_r=o.handleFinished,it=[];it[o.ConnectionEnd.client]=[[i,i,An,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i],[Ee,i,i,i,i,i,i,i,i,i,i,yr,vr,bt,nt,i,i,i,i,i,i],[Ee,i,i,i,i,i,i,i,i,i,i,i,vr,bt,nt,i,i,i,i,i,i],[Ee,i,i,i,i,i,i,i,i,i,i,i,i,bt,nt,i,i,i,i,i,i],[Ee,i,i,i,i,i,i,i,i,i,i,i,i,i,nt,i,i,i,i,i,i],[Ee,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i],[Ee,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,_r],[Ee,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i],[Ee,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i]];var wn=o.handleClientHello,In=o.handleClientKeyExchange,Ln=o.handleCertificateVerify;it[o.ConnectionEnd.server]=[[i,wn,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,yr,i,i,i,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,In,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,Ln,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,_r],[i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i]];o.generateKeys=function(t,r){var a=ot,e=r.client_random+r.server_random;t.session.resuming||(r.master_secret=a(r.pre_master_secret,"master secret",e,48).bytes(),r.pre_master_secret=null),e=r.server_random+r.client_random;var n=2*r.mac_key_length+2*r.enc_key_length,l=t.version.major===o.Versions.TLS_1_0.major&&t.version.minor===o.Versions.TLS_1_0.minor;l&&(n+=2*r.fixed_iv_length);var s=a(r.master_secret,"key expansion",e,n),f={client_write_MAC_key:s.getBytes(r.mac_key_length),server_write_MAC_key:s.getBytes(r.mac_key_length),client_write_key:s.getBytes(r.enc_key_length),server_write_key:s.getBytes(r.enc_key_length)};return l&&(f.client_write_IV=s.getBytes(r.fixed_iv_length),f.server_write_IV=s.getBytes(r.fixed_iv_length)),f};o.createConnectionState=function(t){var r=t.entity===o.ConnectionEnd.client,a=function(){var l={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(s){return!0},compressionState:null,compressFunction:function(s){return!0},updateSequenceNumber:function(){l.sequenceNumber[1]===4294967295?(l.sequenceNumber[1]=0,++l.sequenceNumber[0]):++l.sequenceNumber[1]}};return l},e={read:a(),write:a()};if(e.read.update=function(l,s){return e.read.cipherFunction(s,e.read)?e.read.compressFunction(l,s,e.read)||l.error(l,{message:"Could not decompress record.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.decompression_failure}}):l.error(l,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_record_mac}}),!l.fail},e.write.update=function(l,s){return e.write.compressFunction(l,s,e.write)?e.write.cipherFunction(s,e.write)||l.error(l,{message:"Could not encrypt record.",send:!1,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}):l.error(l,{message:"Could not compress record.",send:!1,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}),!l.fail},t.session){var n=t.session.sp;switch(t.session.cipherSuite.initSecurityParameters(n),n.keys=o.generateKeys(t,n),e.read.macKey=r?n.keys.server_write_MAC_key:n.keys.client_write_MAC_key,e.write.macKey=r?n.keys.client_write_MAC_key:n.keys.server_write_MAC_key,t.session.cipherSuite.initConnectionState(e,t,n),n.compression_algorithm){case o.CompressionMethod.none:break;case o.CompressionMethod.deflate:e.read.compressFunction=mn,e.write.compressFunction=vn;break;default:throw new Error("Unsupported compression algorithm.")}}return e};o.createRandom=function(){var t=new Date,r=+t+t.getTimezoneOffset()*6e4,a=c.util.createBuffer();return a.putInt32(r),a.putBytes(c.random.getBytes(28)),a};o.createRecord=function(t,r){if(!r.data)return null;var a={type:r.type,version:{major:t.version.major,minor:t.version.minor},length:r.data.length(),fragment:r.data};return a};o.createAlert=function(t,r){var a=c.util.createBuffer();return a.putByte(r.level),a.putByte(r.description),o.createRecord(t,{type:o.ContentType.alert,data:a})};o.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};for(var r=c.util.createBuffer(),a=0;a<t.cipherSuites.length;++a){var e=t.cipherSuites[a];r.putByte(e.id[0]),r.putByte(e.id[1])}var n=r.length(),l=c.util.createBuffer();l.putByte(o.CompressionMethod.none);var s=l.length(),f=c.util.createBuffer();if(t.virtualHost){var p=c.util.createBuffer();p.putByte(0),p.putByte(0);var d=c.util.createBuffer();d.putByte(0),ue(d,2,c.util.createBuffer(t.virtualHost));var u=c.util.createBuffer();ue(u,2,d),ue(p,2,u),f.putBuffer(p)}var v=f.length();v>0&&(v+=2);var g=t.session.id,C=g.length+1+2+4+28+2+n+1+s+v,h=c.util.createBuffer();return h.putByte(o.HandshakeType.client_hello),h.putInt24(C),h.putByte(t.version.major),h.putByte(t.version.minor),h.putBytes(t.session.sp.client_random),ue(h,1,c.util.createBuffer(g)),ue(h,2,r),ue(h,1,l),v>0&&ue(h,2,f),h};o.createServerHello=function(t){var r=t.session.id,a=r.length+1+2+4+28+2+1,e=c.util.createBuffer();return e.putByte(o.HandshakeType.server_hello),e.putInt24(a),e.putByte(t.version.major),e.putByte(t.version.minor),e.putBytes(t.session.sp.server_random),ue(e,1,c.util.createBuffer(r)),e.putByte(t.session.cipherSuite.id[0]),e.putByte(t.session.cipherSuite.id[1]),e.putByte(t.session.compressionMethod),e};o.createCertificate=function(t){var r=t.entity===o.ConnectionEnd.client,a=null;if(t.getCertificate){var e;r?e=t.session.certificateRequest:e=t.session.extensions.server_name.serverNameList,a=t.getCertificate(t,e)}var n=c.util.createBuffer();if(a!==null)try{c.util.isArray(a)||(a=[a]);for(var l=null,s=0;s<a.length;++s){var f=c.pem.decode(a[s])[0];if(f.type!=="CERTIFICATE"&&f.type!=="X509 CERTIFICATE"&&f.type!=="TRUSTED CERTIFICATE"){var p=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw p.headerType=f.type,p}if(f.procType&&f.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var d=c.util.createBuffer(f.body);l===null&&(l=c.asn1.fromDer(d.bytes(),!1));var u=c.util.createBuffer();ue(u,3,d),n.putBuffer(u)}a=c.pki.certificateFromAsn1(l),r?t.session.clientCertificate=a:t.session.serverCertificate=a}catch(C){return t.error(t,{message:"Could not send certificate list.",cause:C,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate}})}var v=3+n.length(),g=c.util.createBuffer();return g.putByte(o.HandshakeType.certificate),g.putInt24(v),ue(g,3,n),g};o.createClientKeyExchange=function(t){var r=c.util.createBuffer();r.putByte(t.session.clientHelloVersion.major),r.putByte(t.session.clientHelloVersion.minor),r.putBytes(c.random.getBytes(46));var a=t.session.sp;a.pre_master_secret=r.getBytes();var e=t.session.serverCertificate.publicKey;r=e.encrypt(a.pre_master_secret);var n=r.length+2,l=c.util.createBuffer();return l.putByte(o.HandshakeType.client_key_exchange),l.putInt24(n),l.putInt16(r.length),l.putBytes(r),l};o.createServerKeyExchange=function(t){var r=0,a=c.util.createBuffer();return r>0&&(a.putByte(o.HandshakeType.server_key_exchange),a.putInt24(r)),a};o.getClientSignature=function(t,r){var a=c.util.createBuffer();a.putBuffer(t.session.md5.digest()),a.putBuffer(t.session.sha1.digest()),a=a.getBytes(),t.getSignature=t.getSignature||function(e,n,l){var s=null;if(e.getPrivateKey)try{s=e.getPrivateKey(e,e.session.clientCertificate),s=c.pki.privateKeyFromPem(s)}catch(f){e.error(e,{message:"Could not get private key.",cause:f,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}})}s===null?e.error(e,{message:"No private key set.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}):n=s.sign(n,null),l(e,n)},t.getSignature(t,a,r)};o.createCertificateVerify=function(t,r){var a=r.length+2,e=c.util.createBuffer();return e.putByte(o.HandshakeType.certificate_verify),e.putInt24(a),e.putInt16(r.length),e.putBytes(r),e};o.createCertificateRequest=function(t){var r=c.util.createBuffer();r.putByte(1);var a=c.util.createBuffer();for(var e in t.caStore.certs){var n=t.caStore.certs[e],l=c.pki.distinguishedNameToAsn1(n.subject),s=c.asn1.toDer(l);a.putInt16(s.length()),a.putBuffer(s)}var f=1+r.length()+2+a.length(),p=c.util.createBuffer();return p.putByte(o.HandshakeType.certificate_request),p.putInt24(f),ue(p,1,r),ue(p,2,a),p};o.createServerHelloDone=function(t){var r=c.util.createBuffer();return r.putByte(o.HandshakeType.server_hello_done),r.putInt24(0),r};o.createChangeCipherSpec=function(){var t=c.util.createBuffer();return t.putByte(1),t};o.createFinished=function(t){var r=c.util.createBuffer();r.putBuffer(t.session.md5.digest()),r.putBuffer(t.session.sha1.digest());var a=t.entity===o.ConnectionEnd.client,e=t.session.sp,n=12,l=ot,s=a?"client finished":"server finished";r=l(e.master_secret,s,r.getBytes(),n);var f=c.util.createBuffer();return f.putByte(o.HandshakeType.finished),f.putInt24(r.length()),f.putBuffer(r),f};o.createHeartbeat=function(t,r,a){typeof a>"u"&&(a=r.length);var e=c.util.createBuffer();e.putByte(t),e.putInt16(a),e.putBytes(r);var n=e.length(),l=Math.max(16,n-a-3);return e.putBytes(c.random.getBytes(l)),e};o.queue=function(t,r){if(r&&!(r.fragment.length()===0&&(r.type===o.ContentType.handshake||r.type===o.ContentType.alert||r.type===o.ContentType.change_cipher_spec))){if(r.type===o.ContentType.handshake){var a=r.fragment.bytes();t.session.md5.update(a),t.session.sha1.update(a),a=null}var e;if(r.fragment.length()<=o.MaxFragment)e=[r];else{e=[];for(var n=r.fragment.bytes();n.length>o.MaxFragment;)e.push(o.createRecord(t,{type:r.type,data:c.util.createBuffer(n.slice(0,o.MaxFragment))})),n=n.slice(o.MaxFragment);n.length>0&&e.push(o.createRecord(t,{type:r.type,data:c.util.createBuffer(n)}))}for(var l=0;l<e.length&&!t.fail;++l){var s=e[l],f=t.state.current.write;f.update(t,s)&&t.records.push(s)}}};o.flush=function(t){for(var r=0;r<t.records.length;++r){var a=t.records[r];t.tlsData.putByte(a.type),t.tlsData.putByte(a.version.major),t.tlsData.putByte(a.version.minor),t.tlsData.putInt16(a.fragment.length()),t.tlsData.putBuffer(t.records[r].fragment)}return t.records=[],t.tlsDataReady(t)};var Bt=function(t){switch(t){case!0:return!0;case c.pki.certificateError.bad_certificate:return o.Alert.Description.bad_certificate;case c.pki.certificateError.unsupported_certificate:return o.Alert.Description.unsupported_certificate;case c.pki.certificateError.certificate_revoked:return o.Alert.Description.certificate_revoked;case c.pki.certificateError.certificate_expired:return o.Alert.Description.certificate_expired;case c.pki.certificateError.certificate_unknown:return o.Alert.Description.certificate_unknown;case c.pki.certificateError.unknown_ca:return o.Alert.Description.unknown_ca;default:return o.Alert.Description.bad_certificate}},Dn=function(t){switch(t){case!0:return!0;case o.Alert.Description.bad_certificate:return c.pki.certificateError.bad_certificate;case o.Alert.Description.unsupported_certificate:return c.pki.certificateError.unsupported_certificate;case o.Alert.Description.certificate_revoked:return c.pki.certificateError.certificate_revoked;case o.Alert.Description.certificate_expired:return c.pki.certificateError.certificate_expired;case o.Alert.Description.certificate_unknown:return c.pki.certificateError.certificate_unknown;case o.Alert.Description.unknown_ca:return c.pki.certificateError.unknown_ca;default:return c.pki.certificateError.bad_certificate}};o.verifyCertificateChain=function(t,r){try{var a={};for(var e in t.verifyOptions)a[e]=t.verifyOptions[e];a.verify=function(l,s,f){var p=Bt(l),d=t.verify(t,l,s,f);if(d!==!0){if(typeof d=="object"&&!c.util.isArray(d)){var u=new Error("The application rejected the certificate.");throw u.send=!0,u.alert={level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate},d.message&&(u.message=d.message),d.alert&&(u.alert.description=d.alert),u}d!==l&&(d=Dn(d))}return d},c.pki.verifyCertificateChain(t.caStore,r,a)}catch(l){var n=l;(typeof n!="object"||c.util.isArray(n))&&(n={send:!0,alert:{level:o.Alert.Level.fatal,description:Bt(l)}}),"send"in n||(n.send=!0),"alert"in n||(n.alert={level:o.Alert.Level.fatal,description:Bt(n.error)}),t.error(t,n)}return!t.fail};o.createSessionCache=function(t,r){var a=null;if(t&&t.getSession&&t.setSession&&t.order)a=t;else{a={},a.cache=t||{},a.capacity=Math.max(r||100,1),a.order=[];for(var e in t)a.order.length<=r?a.order.push(e):delete t[e];a.getSession=function(n){var l=null,s=null;if(n?s=c.util.bytesToHex(n):a.order.length>0&&(s=a.order[0]),s!==null&&s in a.cache){l=a.cache[s],delete a.cache[s];for(var f in a.order)if(a.order[f]===s){a.order.splice(f,1);break}}return l},a.setSession=function(n,l){if(a.order.length===a.capacity){var s=a.order.shift();delete a.cache[s]}var s=c.util.bytesToHex(n);a.order.push(s),a.cache[s]=l}}return a};o.createConnection=function(t){var r=null;t.caStore?c.util.isArray(t.caStore)?r=c.pki.createCaStore(t.caStore):r=t.caStore:r=c.pki.createCaStore();var a=t.cipherSuites||null;if(a===null){a=[];for(var e in o.CipherSuites)a.push(o.CipherSuites[e])}var n=t.server?o.ConnectionEnd.server:o.ConnectionEnd.client,l=t.sessionCache?o.createSessionCache(t.sessionCache):null,s={version:{major:o.Version.major,minor:o.Version.minor},entity:n,sessionId:t.sessionId,caStore:r,sessionCache:l,cipherSuites:a,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(u,v,g,C){return v},verifyOptions:t.verifyOptions||{},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:c.util.createBuffer(),tlsData:c.util.createBuffer(),data:c.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:function(u,v){v.origin=v.origin||(u.entity===o.ConnectionEnd.client?"client":"server"),v.send&&(o.queue(u,o.createAlert(u,v.alert)),o.flush(u));var g=v.fatal!==!1;g&&(u.fail=!0),t.error(u,v),g&&u.close(!1)},deflate:t.deflate||null,inflate:t.inflate||null};s.reset=function(u){s.version={major:o.Version.major,minor:o.Version.minor},s.record=null,s.session=null,s.peerCertificate=null,s.state={pending:null,current:null},s.expect=s.entity===o.ConnectionEnd.client?gn:En,s.fragmented=null,s.records=[],s.open=!1,s.handshakes=0,s.handshaking=!1,s.isConnected=!1,s.fail=!(u||typeof u>"u"),s.input.clear(),s.tlsData.clear(),s.data.clear(),s.state.current=o.createConnectionState(s)},s.reset();var f=function(u,v){var g=v.type-o.ContentType.change_cipher_spec,C=xt[u.entity][u.expect];g in C?C[g](u,v):o.handleUnexpected(u,v)},p=function(u){var v=0,g=u.input,C=g.length();if(C<5)v=5-C;else{u.record={type:g.getByte(),version:{major:g.getByte(),minor:g.getByte()},length:g.getInt16(),fragment:c.util.createBuffer(),ready:!1};var h=u.record.version.major===u.version.major;h&&u.session&&u.session.version&&(h=u.record.version.minor===u.version.minor),h||u.error(u,{message:"Incompatible TLS version.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}})}return v},d=function(u){var v=0,g=u.input,C=g.length();if(C<u.record.length)v=u.record.length-C;else{u.record.fragment.putBytes(g.getBytes(u.record.length)),g.compact();var h=u.state.current.read;h.update(u,u.record)&&(u.fragmented!==null&&(u.fragmented.type===u.record.type?(u.fragmented.fragment.putBuffer(u.record.fragment),u.record=u.fragmented):u.error(u,{message:"Invalid fragmented record.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unexpected_message}})),u.record.ready=!0)}return v};return s.handshake=function(u){if(s.entity!==o.ConnectionEnd.client)s.error(s,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(s.handshaking)s.error(s,{message:"Handshake already in progress.",fatal:!1});else{s.fail&&!s.open&&s.handshakes===0&&(s.fail=!1),s.handshaking=!0,u=u||"";var v=null;u.length>0&&(s.sessionCache&&(v=s.sessionCache.getSession(u)),v===null&&(u="")),u.length===0&&s.sessionCache&&(v=s.sessionCache.getSession(),v!==null&&(u=v.id)),s.session={id:u,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:c.md.md5.create(),sha1:c.md.sha1.create()},v&&(s.version=v.version,s.session.sp=v.sp),s.session.sp.client_random=o.createRandom().getBytes(),s.open=!0,o.queue(s,o.createRecord(s,{type:o.ContentType.handshake,data:o.createClientHello(s)})),o.flush(s)}},s.process=function(u){var v=0;return u&&s.input.putBytes(u),s.fail||(s.record!==null&&s.record.ready&&s.record.fragment.isEmpty()&&(s.record=null),s.record===null&&(v=p(s)),!s.fail&&s.record!==null&&!s.record.ready&&(v=d(s)),!s.fail&&s.record!==null&&s.record.ready&&f(s,s.record)),v},s.prepare=function(u){return o.queue(s,o.createRecord(s,{type:o.ContentType.application_data,data:c.util.createBuffer(u)})),o.flush(s)},s.prepareHeartbeatRequest=function(u,v){return u instanceof c.util.ByteBuffer&&(u=u.bytes()),typeof v>"u"&&(v=u.length),s.expectedHeartbeatPayload=u,o.queue(s,o.createRecord(s,{type:o.ContentType.heartbeat,data:o.createHeartbeat(o.HeartbeatMessageType.heartbeat_request,u,v)})),o.flush(s)},s.close=function(u){if(!s.fail&&s.sessionCache&&s.session){var v={id:s.session.id,version:s.session.version,sp:s.session.sp};v.sp.keys=null,s.sessionCache.setSession(v.id,v)}s.open&&(s.open=!1,s.input.clear(),(s.isConnected||s.handshaking)&&(s.isConnected=s.handshaking=!1,o.queue(s,o.createAlert(s,{level:o.Alert.Level.warning,description:o.Alert.Description.close_notify})),o.flush(s)),s.closed(s)),s.reset(u)},s};Cr.exports=c.tls=c.tls||{};for(at in o)typeof o[at]!="function"&&(c.tls[at]=o[at]);var at;c.tls.prf_tls1=ot;c.tls.hmac_sha1=pn;c.tls.createSessionCache=o.createSessionCache;c.tls.createConnection=o.createConnection});var Er=pe((la,Br)=>{"use strict";var Se=Ce();gt();kt();var fe=Br.exports=Se.tls;fe.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=fe.BulkCipherAlgorithm.aes,t.cipher_type=fe.CipherType.block,t.enc_key_length=16,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=fe.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:br};fe.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=fe.BulkCipherAlgorithm.aes,t.cipher_type=fe.CipherType.block,t.enc_key_length=32,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=fe.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:br};function br(t,r,a){var e=r.entity===Se.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:Se.cipher.createDecipher("AES-CBC",e?a.keys.server_write_key:a.keys.client_write_key),iv:e?a.keys.server_write_IV:a.keys.client_write_IV},t.write.cipherState={init:!1,cipher:Se.cipher.createCipher("AES-CBC",e?a.keys.client_write_key:a.keys.server_write_key),iv:e?a.keys.client_write_IV:a.keys.server_write_IV},t.read.cipherFunction=Hn,t.write.cipherFunction=Nn,t.read.macLength=t.write.macLength=a.mac_length,t.read.macFunction=t.write.macFunction=fe.hmac_sha1}function Nn(t,r){var a=!1,e=r.macFunction(r.macKey,r.sequenceNumber,t);t.fragment.putBytes(e),r.updateSequenceNumber();var n;t.version.minor===fe.Versions.TLS_1_0.minor?n=r.cipherState.init?null:r.cipherState.iv:n=Se.random.getBytesSync(16),r.cipherState.init=!0;var l=r.cipherState.cipher;return l.start({iv:n}),t.version.minor>=fe.Versions.TLS_1_1.minor&&l.output.putBytes(n),l.update(t.fragment),l.finish(Kn)&&(t.fragment=l.output,t.length=t.fragment.length(),a=!0),a}function Kn(t,r,a){if(!a){var e=t-r.length()%t;r.fillWithByte(e-1,e)}return!0}function Mn(t,r,a){var e=!0;if(a){for(var n=r.length(),l=r.last(),s=n-1-l;s<n-1;++s)e=e&&r.at(s)==l;e&&r.truncate(l+1)}return e}function Hn(t,r){var a=!1,e;t.version.minor===fe.Versions.TLS_1_0.minor?e=r.cipherState.init?null:r.cipherState.iv:e=t.fragment.getBytes(16),r.cipherState.init=!0;var n=r.cipherState.cipher;n.start({iv:e}),n.update(t.fragment),a=n.finish(Mn);var l=r.macLength,s=Se.random.getBytesSync(l),f=n.output.length();f>=l?(t.fragment=n.output.getBytes(f-l),s=n.output.getBytes(l)):t.fragment=n.output.getBytes(),t.fragment=Se.util.createBuffer(t.fragment),t.length=t.fragment.length();var p=r.macFunction(r.macKey,r.sequenceNumber,t);return r.updateSequenceNumber(),a=Rn(r.macKey,s,p)&&a,a}function Rn(t,r,a){var e=Se.hmac.create();return e.start("SHA1",t),e.update(r),r=e.digest().getBytes(),e.start(null,null),e.update(a),a=e.digest().getBytes(),r===a}});var Sr=pe(Tt=>{"use strict";var qn=Ce();ht();var N=qn.asn1;Tt.privateKeyValidator={name:"PrivateKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Tt.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:N.Class.UNIVERSAL,type:N.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var Rr=pe((fa,Hr)=>{"use strict";var H=Ce();ir();$e();sr();Te();var Ir=Sr(),Fn=Ir.publicKeyValidator,Pn=Ir.privateKeyValidator;typeof xr>"u"&&(xr=H.jsbn.BigInteger);var xr,It=H.util.ByteBuffer,ne=typeof Buffer>"u"?Uint8Array:Buffer;H.pki=H.pki||{};Hr.exports=H.pki.ed25519=H.ed25519=H.ed25519||{};var _=H.ed25519;_.constants={};_.constants.PUBLIC_KEY_BYTE_LENGTH=32;_.constants.PRIVATE_KEY_BYTE_LENGTH=64;_.constants.SEED_BYTE_LENGTH=32;_.constants.SIGN_BYTE_LENGTH=64;_.constants.HASH_BYTE_LENGTH=64;_.generateKeyPair=function(t){t=t||{};var r=t.seed;if(r===void 0)r=H.random.getBytesSync(_.constants.SEED_BYTE_LENGTH);else if(typeof r=="string"){if(r.length!==_.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+_.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(r instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');r=be({message:r,encoding:"binary"});for(var a=new ne(_.constants.PUBLIC_KEY_BYTE_LENGTH),e=new ne(_.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)e[n]=r[n];return Un(a,e),{publicKey:a,privateKey:e}};_.privateKeyFromAsn1=function(t){var r={},a=[],e=H.asn1.validate(t,Pn,r,a);if(!e){var n=new Error("Invalid Key.");throw n.errors=a,n}var l=H.asn1.derToOid(r.privateKeyOid),s=H.oids.EdDSA25519;if(l!==s)throw new Error('Invalid OID "'+l+'"; OID must be "'+s+'".');var f=r.privateKey,p=be({message:H.asn1.fromDer(f).value,encoding:"binary"});return{privateKeyBytes:p}};_.publicKeyFromAsn1=function(t){var r={},a=[],e=H.asn1.validate(t,Fn,r,a);if(!e){var n=new Error("Invalid Key.");throw n.errors=a,n}var l=H.asn1.derToOid(r.publicKeyOid),s=H.oids.EdDSA25519;if(l!==s)throw new Error('Invalid OID "'+l+'"; OID must be "'+s+'".');var f=r.ed25519PublicKey;if(f.length!==_.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return be({message:f,encoding:"binary"})};_.publicKeyFromPrivateKey=function(t){t=t||{};var r=be({message:t.privateKey,encoding:"binary"});if(r.length!==_.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+_.constants.PRIVATE_KEY_BYTE_LENGTH);for(var a=new ne(_.constants.PUBLIC_KEY_BYTE_LENGTH),e=0;e<a.length;++e)a[e]=r[32+e];return a};_.sign=function(t){t=t||{};var r=be(t),a=be({message:t.privateKey,encoding:"binary"});if(a.length===_.constants.SEED_BYTE_LENGTH){var e=_.generateKeyPair({seed:a});a=e.privateKey}else if(a.length!==_.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+_.constants.SEED_BYTE_LENGTH+" or "+_.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new ne(_.constants.SIGN_BYTE_LENGTH+r.length);On(n,r,r.length,a);for(var l=new ne(_.constants.SIGN_BYTE_LENGTH),s=0;s<l.length;++s)l[s]=n[s];return l};_.verify=function(t){t=t||{};var r=be(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var a=be({message:t.signature,encoding:"binary"});if(a.length!==_.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+_.constants.SIGN_BYTE_LENGTH);var e=be({message:t.publicKey,encoding:"binary"});if(e.length!==_.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+_.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new ne(_.constants.SIGN_BYTE_LENGTH+r.length),l=new ne(_.constants.SIGN_BYTE_LENGTH+r.length),s;for(s=0;s<_.constants.SIGN_BYTE_LENGTH;++s)n[s]=a[s];for(s=0;s<r.length;++s)n[s+_.constants.SIGN_BYTE_LENGTH]=r[s];return Yn(l,n,n.length,e)>=0};function be(t){var r=t.message;if(r instanceof Uint8Array||r instanceof ne)return r;var a=t.encoding;if(r===void 0)if(t.md)r=t.md.digest().getBytes(),a="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof r=="string"&&!a)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof r=="string"){if(typeof Buffer<"u")return Buffer.from(r,a);r=new It(r,a)}else if(!(r instanceof It))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var e=new ne(r.length()),n=0;n<e.length;++n)e[n]=r.at(n);return e}var Lt=m(),st=m([1]),Vn=m([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Gn=m([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),kr=m([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Tr=m([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),At=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),jn=m([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Pe(t,r){var a=H.md.sha512.create(),e=new It(t);a.update(e.getBytes(r),"binary");var n=a.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(n,"binary");for(var l=new ne(_.constants.HASH_BYTE_LENGTH),s=0;s<64;++s)l[s]=n.charCodeAt(s);return l}function Un(t,r){var a=[m(),m(),m(),m()],e,n=Pe(r,32);for(n[0]&=248,n[31]&=127,n[31]|=64,Mt(a,n),Kt(t,a),e=0;e<32;++e)r[e+32]=t[e];return 0}function On(t,r,a,e){var n,l,s=new Float64Array(64),f=[m(),m(),m(),m()],p=Pe(e,32);p[0]&=248,p[31]&=127,p[31]|=64;var d=a+64;for(n=0;n<a;++n)t[64+n]=r[n];for(n=0;n<32;++n)t[32+n]=p[32+n];var u=Pe(t.subarray(32),a+32);for(Dt(u),Mt(f,u),Kt(t,f),n=32;n<64;++n)t[n]=e[n];var v=Pe(t,a+64);for(Dt(v),n=32;n<64;++n)s[n]=0;for(n=0;n<32;++n)s[n]=u[n];for(n=0;n<32;++n)for(l=0;l<32;l++)s[n+l]+=v[n]*p[l];return Lr(t.subarray(32),s),d}function Yn(t,r,a,e){var n,l,s=new ne(32),f=[m(),m(),m(),m()],p=[m(),m(),m(),m()];if(l=-1,a<64||zn(p,e))return-1;for(n=0;n<a;++n)t[n]=r[n];for(n=0;n<32;++n)t[n+32]=e[n];var d=Pe(t,a);if(Dt(d),Kr(f,p,d),Mt(p,r.subarray(32)),Nt(f,p),Kt(s,f),a-=64,Dr(r,0,s,0)){for(n=0;n<a;++n)t[n]=0;return-1}for(n=0;n<a;++n)t[n]=r[n+64];return l=a,l}function Lr(t,r){var a,e,n,l;for(e=63;e>=32;--e){for(a=0,n=e-32,l=e-12;n<l;++n)r[n]+=a-16*r[e]*At[n-(e-32)],a=r[n]+128>>8,r[n]-=a*256;r[n]+=a,r[e]=0}for(a=0,n=0;n<32;++n)r[n]+=a-(r[31]>>4)*At[n],a=r[n]>>8,r[n]&=255;for(n=0;n<32;++n)r[n]-=a*At[n];for(e=0;e<32;++e)r[e+1]+=r[e]>>8,t[e]=r[e]&255}function Dt(t){for(var r=new Float64Array(64),a=0;a<64;++a)r[a]=t[a],t[a]=0;Lr(t,r)}function Nt(t,r){var a=m(),e=m(),n=m(),l=m(),s=m(),f=m(),p=m(),d=m(),u=m();Me(a,t[1],t[0]),Me(u,r[1],r[0]),x(a,a,u),Ke(e,t[0],t[1]),Ke(u,r[0],r[1]),x(e,e,u),x(n,t[3],r[3]),x(n,n,Gn),x(l,t[2],r[2]),Ke(l,l,l),Me(s,e,a),Me(f,l,n),Ke(p,l,n),Ke(d,e,a),x(t[0],s,f),x(t[1],d,p),x(t[2],p,f),x(t[3],s,d)}function Ar(t,r,a){for(var e=0;e<4;++e)Mr(t[e],r[e],a)}function Kt(t,r){var a=m(),e=m(),n=m();Jn(n,r[2]),x(a,r[0],n),x(e,r[1],n),lt(t,e),t[31]^=Nr(a)<<7}function lt(t,r){var a,e,n,l=m(),s=m();for(a=0;a<16;++a)s[a]=r[a];for(wt(s),wt(s),wt(s),e=0;e<2;++e){for(l[0]=s[0]-65517,a=1;a<15;++a)l[a]=s[a]-65535-(l[a-1]>>16&1),l[a-1]&=65535;l[15]=s[15]-32767-(l[14]>>16&1),n=l[15]>>16&1,l[14]&=65535,Mr(s,l,1-n)}for(a=0;a<16;a++)t[2*a]=s[a]&255,t[2*a+1]=s[a]>>8}function zn(t,r){var a=m(),e=m(),n=m(),l=m(),s=m(),f=m(),p=m();return xe(t[2],st),Wn(t[1],r),Ae(n,t[1]),x(l,n,Vn),Me(n,n,t[2]),Ke(l,t[2],l),Ae(s,l),Ae(f,s),x(p,f,s),x(a,p,n),x(a,a,l),Qn(a,a),x(a,a,n),x(a,a,l),x(a,a,l),x(t[0],a,l),Ae(e,t[0]),x(e,e,l),wr(e,n)&&x(t[0],t[0],jn),Ae(e,t[0]),x(e,e,l),wr(e,n)?-1:(Nr(t[0])===r[31]>>7&&Me(t[0],Lt,t[0]),x(t[3],t[0],t[1]),0)}function Wn(t,r){var a;for(a=0;a<16;++a)t[a]=r[2*a]+(r[2*a+1]<<8);t[15]&=32767}function Qn(t,r){var a=m(),e;for(e=0;e<16;++e)a[e]=r[e];for(e=250;e>=0;--e)Ae(a,a),e!==1&&x(a,a,r);for(e=0;e<16;++e)t[e]=a[e]}function wr(t,r){var a=new ne(32),e=new ne(32);return lt(a,t),lt(e,r),Dr(a,0,e,0)}function Dr(t,r,a,e){return Xn(t,r,a,e,32)}function Xn(t,r,a,e,n){var l,s=0;for(l=0;l<n;++l)s|=t[r+l]^a[e+l];return(1&s-1>>>8)-1}function Nr(t){var r=new ne(32);return lt(r,t),r[0]&1}function Kr(t,r,a){var e,n;for(xe(t[0],Lt),xe(t[1],st),xe(t[2],st),xe(t[3],Lt),n=255;n>=0;--n)e=a[n/8|0]>>(n&7)&1,Ar(t,r,e),Nt(r,t),Nt(t,t),Ar(t,r,e)}function Mt(t,r){var a=[m(),m(),m(),m()];xe(a[0],kr),xe(a[1],Tr),xe(a[2],st),x(a[3],kr,Tr),Kr(t,a,r)}function xe(t,r){var a;for(a=0;a<16;a++)t[a]=r[a]|0}function Jn(t,r){var a=m(),e;for(e=0;e<16;++e)a[e]=r[e];for(e=253;e>=0;--e)Ae(a,a),e!==2&&e!==4&&x(a,a,r);for(e=0;e<16;++e)t[e]=a[e]}function wt(t){var r,a,e=1;for(r=0;r<16;++r)a=t[r]+e+65535,e=Math.floor(a/65536),t[r]=a-e*65536;t[0]+=e-1+37*(e-1)}function Mr(t,r,a){for(var e,n=~(a-1),l=0;l<16;++l)e=n&(t[l]^r[l]),t[l]^=e,r[l]^=e}function m(t){var r,a=new Float64Array(16);if(t)for(r=0;r<t.length;++r)a[r]=t[r];return a}function Ke(t,r,a){for(var e=0;e<16;++e)t[e]=r[e]+a[e]}function Me(t,r,a){for(var e=0;e<16;++e)t[e]=r[e]-a[e]}function Ae(t,r){x(t,r,r)}function x(t,r,a){var e,n,l=0,s=0,f=0,p=0,d=0,u=0,v=0,g=0,C=0,h=0,T=0,I=0,S=0,k=0,A=0,w=0,R=0,ee=0,re=0,ae=0,le=0,ce=0,de=0,ye=0,Be=0,ke=0,we=0,qe=0,Oe=0,vt=0,Gt=0,q=a[0],F=a[1],P=a[2],V=a[3],G=a[4],j=a[5],U=a[6],O=a[7],Y=a[8],z=a[9],W=a[10],Q=a[11],X=a[12],J=a[13],Z=a[14],$=a[15];e=r[0],l+=e*q,s+=e*F,f+=e*P,p+=e*V,d+=e*G,u+=e*j,v+=e*U,g+=e*O,C+=e*Y,h+=e*z,T+=e*W,I+=e*Q,S+=e*X,k+=e*J,A+=e*Z,w+=e*$,e=r[1],s+=e*q,f+=e*F,p+=e*P,d+=e*V,u+=e*G,v+=e*j,g+=e*U,C+=e*O,h+=e*Y,T+=e*z,I+=e*W,S+=e*Q,k+=e*X,A+=e*J,w+=e*Z,R+=e*$,e=r[2],f+=e*q,p+=e*F,d+=e*P,u+=e*V,v+=e*G,g+=e*j,C+=e*U,h+=e*O,T+=e*Y,I+=e*z,S+=e*W,k+=e*Q,A+=e*X,w+=e*J,R+=e*Z,ee+=e*$,e=r[3],p+=e*q,d+=e*F,u+=e*P,v+=e*V,g+=e*G,C+=e*j,h+=e*U,T+=e*O,I+=e*Y,S+=e*z,k+=e*W,A+=e*Q,w+=e*X,R+=e*J,ee+=e*Z,re+=e*$,e=r[4],d+=e*q,u+=e*F,v+=e*P,g+=e*V,C+=e*G,h+=e*j,T+=e*U,I+=e*O,S+=e*Y,k+=e*z,A+=e*W,w+=e*Q,R+=e*X,ee+=e*J,re+=e*Z,ae+=e*$,e=r[5],u+=e*q,v+=e*F,g+=e*P,C+=e*V,h+=e*G,T+=e*j,I+=e*U,S+=e*O,k+=e*Y,A+=e*z,w+=e*W,R+=e*Q,ee+=e*X,re+=e*J,ae+=e*Z,le+=e*$,e=r[6],v+=e*q,g+=e*F,C+=e*P,h+=e*V,T+=e*G,I+=e*j,S+=e*U,k+=e*O,A+=e*Y,w+=e*z,R+=e*W,ee+=e*Q,re+=e*X,ae+=e*J,le+=e*Z,ce+=e*$,e=r[7],g+=e*q,C+=e*F,h+=e*P,T+=e*V,I+=e*G,S+=e*j,k+=e*U,A+=e*O,w+=e*Y,R+=e*z,ee+=e*W,re+=e*Q,ae+=e*X,le+=e*J,ce+=e*Z,de+=e*$,e=r[8],C+=e*q,h+=e*F,T+=e*P,I+=e*V,S+=e*G,k+=e*j,A+=e*U,w+=e*O,R+=e*Y,ee+=e*z,re+=e*W,ae+=e*Q,le+=e*X,ce+=e*J,de+=e*Z,ye+=e*$,e=r[9],h+=e*q,T+=e*F,I+=e*P,S+=e*V,k+=e*G,A+=e*j,w+=e*U,R+=e*O,ee+=e*Y,re+=e*z,ae+=e*W,le+=e*Q,ce+=e*X,de+=e*J,ye+=e*Z,Be+=e*$,e=r[10],T+=e*q,I+=e*F,S+=e*P,k+=e*V,A+=e*G,w+=e*j,R+=e*U,ee+=e*O,re+=e*Y,ae+=e*z,le+=e*W,ce+=e*Q,de+=e*X,ye+=e*J,Be+=e*Z,ke+=e*$,e=r[11],I+=e*q,S+=e*F,k+=e*P,A+=e*V,w+=e*G,R+=e*j,ee+=e*U,re+=e*O,ae+=e*Y,le+=e*z,ce+=e*W,de+=e*Q,ye+=e*X,Be+=e*J,ke+=e*Z,we+=e*$,e=r[12],S+=e*q,k+=e*F,A+=e*P,w+=e*V,R+=e*G,ee+=e*j,re+=e*U,ae+=e*O,le+=e*Y,ce+=e*z,de+=e*W,ye+=e*Q,Be+=e*X,ke+=e*J,we+=e*Z,qe+=e*$,e=r[13],k+=e*q,A+=e*F,w+=e*P,R+=e*V,ee+=e*G,re+=e*j,ae+=e*U,le+=e*O,ce+=e*Y,de+=e*z,ye+=e*W,Be+=e*Q,ke+=e*X,we+=e*J,qe+=e*Z,Oe+=e*$,e=r[14],A+=e*q,w+=e*F,R+=e*P,ee+=e*V,re+=e*G,ae+=e*j,le+=e*U,ce+=e*O,de+=e*Y,ye+=e*z,Be+=e*W,ke+=e*Q,we+=e*X,qe+=e*J,Oe+=e*Z,vt+=e*$,e=r[15],w+=e*q,R+=e*F,ee+=e*P,re+=e*V,ae+=e*G,le+=e*j,ce+=e*U,de+=e*O,ye+=e*Y,Be+=e*z,ke+=e*W,we+=e*Q,qe+=e*X,Oe+=e*J,vt+=e*Z,Gt+=e*$,l+=38*R,s+=38*ee,f+=38*re,p+=38*ae,d+=38*le,u+=38*ce,v+=38*de,g+=38*ye,C+=38*Be,h+=38*ke,T+=38*we,I+=38*qe,S+=38*Oe,k+=38*vt,A+=38*Gt,n=1,e=l+n+65535,n=Math.floor(e/65536),l=e-n*65536,e=s+n+65535,n=Math.floor(e/65536),s=e-n*65536,e=f+n+65535,n=Math.floor(e/65536),f=e-n*65536,e=p+n+65535,n=Math.floor(e/65536),p=e-n*65536,e=d+n+65535,n=Math.floor(e/65536),d=e-n*65536,e=u+n+65535,n=Math.floor(e/65536),u=e-n*65536,e=v+n+65535,n=Math.floor(e/65536),v=e-n*65536,e=g+n+65535,n=Math.floor(e/65536),g=e-n*65536,e=C+n+65535,n=Math.floor(e/65536),C=e-n*65536,e=h+n+65535,n=Math.floor(e/65536),h=e-n*65536,e=T+n+65535,n=Math.floor(e/65536),T=e-n*65536,e=I+n+65535,n=Math.floor(e/65536),I=e-n*65536,e=S+n+65535,n=Math.floor(e/65536),S=e-n*65536,e=k+n+65535,n=Math.floor(e/65536),k=e-n*65536,e=A+n+65535,n=Math.floor(e/65536),A=e-n*65536,e=w+n+65535,n=Math.floor(e/65536),w=e-n*65536,l+=n-1+37*(n-1),n=1,e=l+n+65535,n=Math.floor(e/65536),l=e-n*65536,e=s+n+65535,n=Math.floor(e/65536),s=e-n*65536,e=f+n+65535,n=Math.floor(e/65536),f=e-n*65536,e=p+n+65535,n=Math.floor(e/65536),p=e-n*65536,e=d+n+65535,n=Math.floor(e/65536),d=e-n*65536,e=u+n+65535,n=Math.floor(e/65536),u=e-n*65536,e=v+n+65535,n=Math.floor(e/65536),v=e-n*65536,e=g+n+65535,n=Math.floor(e/65536),g=e-n*65536,e=C+n+65535,n=Math.floor(e/65536),C=e-n*65536,e=h+n+65535,n=Math.floor(e/65536),h=e-n*65536,e=T+n+65535,n=Math.floor(e/65536),T=e-n*65536,e=I+n+65535,n=Math.floor(e/65536),I=e-n*65536,e=S+n+65535,n=Math.floor(e/65536),S=e-n*65536,e=k+n+65535,n=Math.floor(e/65536),k=e-n*65536,e=A+n+65535,n=Math.floor(e/65536),A=e-n*65536,e=w+n+65535,n=Math.floor(e/65536),w=e-n*65536,l+=n-1+37*(n-1),t[0]=l,t[1]=s,t[2]=f,t[3]=p,t[4]=d,t[5]=u,t[6]=v,t[7]=g,t[8]=C,t[9]=h,t[10]=T,t[11]=I,t[12]=S,t[13]=k,t[14]=A,t[15]=w}});var Vr=pe((ca,Pr)=>{"use strict";var se=Ce();Te();$e();ir();Pr.exports=se.kem=se.kem||{};var qr=se.jsbn.BigInteger;se.kem.rsa={};se.kem.rsa.create=function(t,r){r=r||{};var a=r.prng||se.random,e={};return e.encrypt=function(n,l){var s=Math.ceil(n.n.bitLength()/8),f;do f=new qr(se.util.bytesToHex(a.getBytesSync(s)),16).mod(n.n);while(f.compareTo(qr.ONE)<=0);f=se.util.hexToBytes(f.toString(16));var p=s-f.length;p>0&&(f=se.util.fillString(String.fromCharCode(0),p)+f);var d=n.encrypt(f,"NONE"),u=t.generate(f,l);return{encapsulation:d,key:u}},e.decrypt=function(n,l,s){var f=n.decrypt(l,"NONE");return t.generate(f,s)},e};se.kem.kdf1=function(t,r){Fr(this,t,0,r||t.digestLength)};se.kem.kdf2=function(t,r){Fr(this,t,1,r||t.digestLength)};function Fr(t,r,a,e){t.generate=function(n,l){for(var s=new se.util.ByteBuffer,f=Math.ceil(l/e)+a,p=new se.util.ByteBuffer,d=a;d<f;++d){p.putInt32(d),r.start(),r.update(n+p.getBytes());var u=r.digest();s.putBytes(u.getBytes(e))}return s.truncate(s.length()-l),s.getBytes()}}});var Or=pe((da,Ur)=>{"use strict";var b=Ce();Te();Ur.exports=b.log=b.log||{};b.log.levels=["none","error","warning","info","debug","verbose","max"];var ut={},qt=[],Ge=null;b.log.LEVEL_LOCKED=2;b.log.NO_LEVEL_CHECK=4;b.log.INTERPOLATE=8;for(ge=0;ge<b.log.levels.length;++ge)Ht=b.log.levels[ge],ut[Ht]={index:ge,name:Ht.toUpperCase()};var Ht,ge;b.log.logMessage=function(t){for(var r=ut[t.level].index,a=0;a<qt.length;++a){var e=qt[a];if(e.flags&b.log.NO_LEVEL_CHECK)e.f(t);else{var n=ut[e.level].index;r<=n&&e.f(e,t)}}};b.log.prepareStandard=function(t){"standard"in t||(t.standard=ut[t.level].name+" ["+t.category+"] "+t.message)};b.log.prepareFull=function(t){if(!("full"in t)){var r=[t.message];r=r.concat([]),t.full=b.util.format.apply(this,r)}};b.log.prepareStandardFull=function(t){"standardFull"in t||(b.log.prepareStandard(t),t.standardFull=t.standard)};for(Rt=["error","warning","info","debug","verbose"],ge=0;ge<Rt.length;++ge)(function(r){b.log[r]=function(a,e){var n=Array.prototype.slice.call(arguments).slice(2),l={timestamp:new Date,level:r,category:a,message:e,arguments:n};b.log.logMessage(l)}})(Rt[ge]);var Rt,ge;b.log.makeLogger=function(t){var r={flags:0,f:t};return b.log.setLevel(r,"none"),r};b.log.setLevel=function(t,r){var a=!1;if(t&&!(t.flags&b.log.LEVEL_LOCKED))for(var e=0;e<b.log.levels.length;++e){var n=b.log.levels[e];if(r==n){t.level=r,a=!0;break}}return a};b.log.lock=function(t,r){typeof r>"u"||r?t.flags|=b.log.LEVEL_LOCKED:t.flags&=~b.log.LEVEL_LOCKED};b.log.addLogger=function(t){qt.push(t)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(Gr={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},je=function(t,r){b.log.prepareStandard(r);var a=Gr[r.level],e=[r.standard];e=e.concat(r.arguments.slice()),a.apply(console,e)},He=b.log.makeLogger(je)):(je=function(r,a){b.log.prepareStandardFull(a),console.log(a.standardFull)},He=b.log.makeLogger(je)),b.log.setLevel(He,"debug"),b.log.addLogger(He),Ge=He):console={log:function(){}};var He,Gr,je;Ge!==null&&typeof window<"u"&&window.location&&(Ve=new URL(window.location.href).searchParams,Ve.has("console.level")&&b.log.setLevel(Ge,Ve.get("console.level").slice(-1)[0]),Ve.has("console.lock")&&(jr=Ve.get("console.lock").slice(-1)[0],jr=="true"&&b.log.lock(Ge)));var Ve,jr;b.log.consoleLogger=Ge});var zr=pe((pa,Yr)=>{"use strict";Yr.exports=nr();rt();_t();rn();sr()});var Qr=pe((va,Wr)=>{"use strict";var L=Ce();gt();yt();rt();_t();Te();var ct=Wr.exports=L.ssh=L.ssh||{};ct.privateKeyToPutty=function(t,r,a){a=a||"",r=r||"";var e="ssh-rsa",n=r===""?"none":"aes256-cbc",l="PuTTY-User-Key-File-2: "+e+`\r
`;l+="Encryption: "+n+`\r
`,l+="Comment: "+a+`\r
`;var s=L.util.createBuffer();Re(s,e),he(s,t.e),he(s,t.n);var f=L.util.encode64(s.bytes(),64),p=Math.floor(f.length/66)+1;l+="Public-Lines: "+p+`\r
`,l+=f;var d=L.util.createBuffer();he(d,t.d),he(d,t.p),he(d,t.q),he(d,t.qInv);var u;if(!r)u=L.util.encode64(d.bytes(),64);else{var v=d.length()+16-1;v-=v%16;var g=ft(d.bytes());g.truncate(g.length()-v+d.length()),d.putBuffer(g);var C=L.util.createBuffer();C.putBuffer(ft("\0\0\0\0",r)),C.putBuffer(ft("\0\0\0",r));var h=L.aes.createEncryptionCipher(C.truncate(8),"CBC");h.start(L.util.createBuffer().fillWithByte(0,16)),h.update(d.copy()),h.finish();var T=h.output;T.truncate(16),u=L.util.encode64(T.bytes(),64)}p=Math.floor(u.length/66)+1,l+=`\r
Private-Lines: `+p+`\r
`,l+=u;var I=ft("putty-private-key-file-mac-key",r),S=L.util.createBuffer();Re(S,e),Re(S,n),Re(S,a),S.putInt32(s.length()),S.putBuffer(s),S.putInt32(d.length()),S.putBuffer(d);var k=L.hmac.create();return k.start("sha1",I),k.update(S.bytes()),l+=`\r
Private-MAC: `+k.digest().toHex()+`\r
`,l};ct.publicKeyToOpenSSH=function(t,r){var a="ssh-rsa";r=r||"";var e=L.util.createBuffer();return Re(e,a),he(e,t.e),he(e,t.n),a+" "+L.util.encode64(e.bytes())+" "+r};ct.privateKeyToOpenSSH=function(t,r){return r?L.pki.encryptRsaPrivateKey(t,r,{legacy:!0,algorithm:"aes128"}):L.pki.privateKeyToPem(t)};ct.getPublicKeyFingerprint=function(t,r){r=r||{};var a=r.md||L.md.md5.create(),e="ssh-rsa",n=L.util.createBuffer();Re(n,e),he(n,t.e),he(n,t.n),a.start(),a.update(n.getBytes());var l=a.digest();if(r.encoding==="hex"){var s=l.toHex();return r.delimiter?s.match(/.{2}/g).join(r.delimiter):s}else{if(r.encoding==="binary")return l.getBytes();if(r.encoding)throw new Error('Unknown encoding "'+r.encoding+'".')}return l};function he(t,r){var a=r.toString(16);a[0]>="8"&&(a="00"+a);var e=L.util.hexToBytes(a);t.putInt32(e.length),t.putBytes(e)}function Re(t,r){t.putInt32(r.length),t.putString(r)}function ft(){for(var t=L.md.sha1.create(),r=arguments.length,a=0;a<r;++a)t.update(arguments[a]);return t.digest()}});var Ft=pe((ma,Xr)=>{"use strict";Xr.exports=Ce();gt();Er();ht();$r();on();Rr();yt();Vr();Or();zr();en();tn();ar();an();cn();un();or();ln();nn();sn();$e();fn();Qr();kt();Te()});var Ue=jt(Ft());function ta(t,r){if(t&1&&(B(0,"div",23),D(1,"br")(2,"br"),B(3,"h2"),E(4,"Certificate"),y(),B(5,"div",24),E(6),y(),D(7,"br"),B(8,"h2"),E(9,"Private Key"),y(),B(10,"div",25),E(11),y()()),t&2){let a=Qe();ie(6),De(" ",a.pemCert," "),ie(5),De(" ",a.pemPrivateKey," ")}}var Pt=(()=>{let r=class r{constructor(e){this.fb=e}ngOnInit(){this.createCertificateInformationForm()}onSubmit(){this.generateCertificate()}resetForm(){this.certificateInformationForm.enable(),this.pemCert="",this.pemPrivateKey=""}createCertificateInformationForm(){this.certificateInformationForm=this.fb.group({commonName:["",_e.required],countryName:["",_e.required],ST:["",_e.required],localityName:["",_e.required],organizationName:["",_e.required],OU:["",_e.required],fromDate:[null,[_e.required]],toDate:[null,[_e.required]]},{validator:this.dateValidator})}dateValidator(e){let n=new Date(e.get("fromDate").value),l=new Date(e.get("toDate").value);return n<new Date||l<=n?{dateRangeError:!0}:null}generateCertificate(){let e=Ue.pki.rsa.generateKeyPair(2048),n=Ue.pki.createCertificate();n.publicKey=e.publicKey,n.serialNumber="01",n.validity.notBefore=new Date(this.certificateInformationForm.get("fromDate").value),n.validity.notAfter=new Date(this.certificateInformationForm.get("toDate").value),n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+1);let l=[{name:"commonName",value:this.certificateInformationForm.get("commonName").value},{name:"countryName",value:this.certificateInformationForm.get("countryName").value},{shortName:"ST",value:this.certificateInformationForm.get("ST").value},{name:"localityName",value:this.certificateInformationForm.get("localityName").value},{name:"organizationName",value:this.certificateInformationForm.get("organizationName").value},{shortName:"OU",value:this.certificateInformationForm.get("OU").value}];n.setSubject(l),n.setIssuer(l),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(e.privateKey),this.pemCert=Ue.pki.certificateToPem(n),this.pemPrivateKey=Ue.pki.privateKeyToPem(e.privateKey),this.certificateInformationForm.disable()}};r.\u0275fac=function(n){return new(n||r)(Ut(tr))},r.\u0275cmp=Ie({type:r,selectors:[["app-generate-rsa-certificate"]],decls:40,vars:4,consts:[["autocomplete","off",1,"form",3,"formGroup","ngSubmit"],[1,"flex-container","flex-container-2x"],[1,"form-group"],["for","commonName"],["type","text","id","commonName","formControlName","commonName","placeholder","Eg. John Smith",1,"form-control"],["for","countryName"],["type","text","id","countryName","formControlName","countryName","placeholder","Eg. India",1,"form-control"],["for","ST"],["type","text","id","ST","formControlName","ST","placeholder","Eg. West Bengal",1,"form-control"],["for","localityName"],["type","text","id","localityName","formControlName","localityName","placeholder","Eg. Hind Motor",1,"form-control"],["for","organizationName"],["type","text","id","organizationName","formControlName","organizationName","placeholder","Eg. Abc",1,"form-control"],["for","OU"],["type","text","id","OU","formControlName","OU","placeholder","Eg. Xyz",1,"form-control"],["for","fromDate"],["type","date","id","fromDate","formControlName","fromDate",1,"form-control"],["for","toDate"],["type","date","id","toDate","formControlName","toDate",1,"form-control"],[1,"flex-container"],["mat-raised-button","","color","accent","type","reset",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["class","group-wrap",4,"ngIf"],[1,"group-wrap"],[1,"publicKey"],[1,"privateKey"]],template:function(n,l){n&1&&(B(0,"form",0),Le("ngSubmit",function(){return l.onSubmit()}),B(1,"div",1)(2,"div",2)(3,"label",3),E(4,"Common Name"),y(),D(5,"input",4),y(),B(6,"div",2)(7,"label",5),E(8,"Country Name"),y(),D(9,"input",6),y(),B(10,"div",2)(11,"label",7),E(12,"State"),y(),D(13,"input",8),y(),B(14,"div",2)(15,"label",9),E(16,"Locality Name"),y(),D(17,"input",10),y(),B(18,"div",2)(19,"label",11),E(20,"Organization Name"),y(),D(21,"input",12),y(),B(22,"div",2)(23,"label",13),E(24,"Organization Unit"),y(),D(25,"input",14),y(),B(26,"div",2)(27,"label",15),E(28,"From Date"),y(),D(29,"input",16),y(),B(30,"div",2)(31,"label",17),E(32,"To Date"),y(),D(33,"input",18),y()(),B(34,"div",19)(35,"button",20),Le("click",function(){return l.resetForm()}),E(36,"RESET"),y(),B(37,"button",21),E(38,"SUBMIT"),y()()(),We(39,ta,12,2,"div",22)),n&2&&(ve("formGroup",l.certificateInformationForm),ie(35),ve("disabled",!l.certificateInformationForm.touched&&!l.certificateInformationForm.dirty),ie(2),ve("disabled",!l.certificateInformationForm.valid),ie(2),ve("ngIf",l.pemCert&&l.pemPrivateKey))},dependencies:[Xe,Ze,Wt,Qt,Je,Jt,Zt,et]});let t=r;return t})();var pt=jt(Ft());function na(t,r){if(t&1&&(B(0,"div",0)(1,"h2"),E(2,"Public Key"),y(),B(3,"div",13),E(4),y(),D(5,"br"),B(6,"h2"),E(7,"Private Key"),y(),B(8,"div",14),E(9),y()()),t&2){let a=Qe();ie(4),De(" ",a.rsaKeyPair.publicKey," "),ie(5),De(" ",a.rsaKeyPair.privateKey," ")}}var Vt=(()=>{let r=class r{constructor(){this.rsaKeyPair=null,this.bitSize="",this.keyType=""}generateKeyPair(){this.rsaKeyPair=null;let e=pt.pki.rsa.generateKeyPair({bits:this.bitSize});this.rsaKeyPair={privateKey:pt.pki.privateKeyToPem(e.privateKey),publicKey:pt.pki.publicKeyToPem(e.publicKey)}}setBitSize(e){e.target.value&&(this.bitSize=e.target.value)}};r.\u0275fac=function(n){return new(n||r)},r.\u0275cmp=Ie({type:r,selectors:[["app-generate-rsa-key"]],decls:22,vars:2,consts:[[1,"group-wrap"],[1,"form"],[1,"form-group"],["for","bitSize"],["id","bitSize","name","bitSize",1,"form-control",3,"change"],["value",""],["value","128"],["value","256"],["value","512"],["value","1024"],["value","2048"],["mat-raised-button","","color","primary",3,"disabled","click"],["class","group-wrap",4,"ngIf"],[1,"publicKey"],[1,"privateKey"]],template:function(n,l){n&1&&(B(0,"div",0)(1,"form",1)(2,"div",2)(3,"label",3),E(4,"Select Bit Size"),y(),B(5,"select",4),Le("change",function(f){return l.setBitSize(f)}),B(6,"option",5),E(7,"Select"),y(),B(8,"option",6),E(9,"128"),y(),B(10,"option",7),E(11,"256"),y(),B(12,"option",8),E(13,"512"),y(),B(14,"option",9),E(15,"1024"),y(),B(16,"option",10),E(17,"2048"),y()()(),B(18,"button",11),Le("click",function(){return l.generateKeyPair()}),E(19,"Generate Keys"),y()(),D(20,"br"),y(),We(21,na,10,2,"div",12)),n&2&&(ie(18),ve("disabled",l.bitSize==""),ie(3),ve("ngIf",l.rsaKeyPair!=null))},dependencies:[Xe,Ze,$t,er,Je,et,Xt]});let t=r;return t})();var Jr=(()=>{let r=class r{};r.\u0275fac=function(n){return new(n||r)},r.\u0275cmp=Ie({type:r,selectors:[["app-generate-rsa-key-certificate-master"]],decls:15,vars:1,consts:[[1,"base"],[1,"container"],[1,"row"],[1,"page"],[1,"main-heading"],[1,"group-wrap"],["animationDuration","0ms","mat-stretch-tabs","false","mat-align-tabs","start","dynamicHeight","",3,"color"],["label","Generate Key"],["label","Generate Certificate"]],template:function(n,l){n&1&&(B(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),E(5,"Generate RSA Key / Certificate"),y(),B(6,"div",5)(7,"mat-tab-group",6)(8,"mat-tab",7),D(9,"br")(10,"app-generate-rsa-key"),y(),B(11,"mat-tab",8),D(12,"br")(13,"app-generate-rsa-certificate"),y()()(),D(14,"br"),y()()()()),n&2&&(ie(7),ve("color","primary"))},dependencies:[Yt,zt,Pt,Vt]});let t=r;return t})();var ia=[{path:"",component:Jr}],Zr=(()=>{let r=class r{};r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=ze({type:r}),r.\u0275inj=Ye({imports:[mt.forChild(ia),mt]});let t=r;return t})();var wa=(()=>{let r=class r{};r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=ze({type:r}),r.\u0275inj=Ye({imports:[Ot,Zr,rr,lr]});let t=r;return t})();export{wa as GenerateRsaKeyCertificateModule};
